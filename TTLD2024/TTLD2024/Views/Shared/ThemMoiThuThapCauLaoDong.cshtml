<script src="~/Content/AceAdmin/ace.min.js"></script>
<script src="~/Content/AceAdmin/ace-elements.min.js"></script>
<link href="~/Content/AceAdmin/ace.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/signature_pad@2.3.2/dist/signature_pad.min.js"></script>
<style>
    .text-info {
        color: var(--tblr-color-header) !important;
    }

    .text-line-modal:after {
        content: "";
        width: 100%;
        display: block;
        height: 1px;
        border-bottom: 1px solid var(--tblr-color-header);
    }

    .text-line-modal {
        display: flex;
        align-items: center;
        gap: 10px
    }

    .text-line {
        width: 175px;
        color: var(--tblr-color-header);
        font-weight: bold;
        font-size: 14px !important;
    }

    .line-modal {
        padding-bottom: 1px;
    }

    .display-flex {
        display: flex;
    }

    .align-items-center {
        align-items: center;
    }

    .justify-content-center {
        justify-content: center;
    }

    .modal-footer {
        display: unset !important;
    }

    label.middle {
        display: flex;
        align-items: center;
        justify-content: flex-start;
    }

    span.lbl {
        padding-left: 10px;
    }

    li.step-item {
        display: flex;
        flex-wrap: wrap;
    }

        li.step-item img {
            text-align: center;
            margin: 0 auto;
        }

    #mdThemMoiThuThapCau_us .modal-content {
        height: 100vh;
    }

    .step-item.active ~ .step-item {
        color: #000000;
    }

    .active .h4.m-0 {
        color: var(--tbl-btn-luuvadong);
        font-weight: bold;
        font-size: 15px !important;
    }

    .active .text-dark {
        font-weight: 400 !important;
        color: var(--tbl-btn-luuvadong) !important;
    }

    .box-border-cauld {
        border: 1px var(--tblr-color-header) solid;
        padding: 10px 5px;
        border-radius: 6px;
        border-left: 10px var(--tblr-color-header) solid;
        display: flex;
        align-items: center;
        margin-top: 10px;
    }

    .ace-file-multiple .ace-file-container:before {
        margin: 5px;
    }

    .ace-file-multiple .ace-file-container .ace-file-name .ace-icon {
        line-height: 50px;
        width: auto;
        font-size: 40px;
    }

    .box-img-kyten {
        height: 150px;
        background: #d2d2d2;
        border-radius: 4px;
    }

    .box-input {
        position: absolute;
        bottom: 0;
    }
</style>
<style>
    .vodiapickerDT {
        display: none;
    }

    #ListDataToChuc {
        padding-left: 0px;
    }

        #ListDataToChuc img, .btn-select img {
            width: 20px;
        }

        #ListDataToChuc li {
            list-style: none;
            padding-top: 5px;
            padding-bottom: 5px;
            padding-left: 10px;
            display: flex;
            flex-wrap: nowrap;
            align-items: center;
        }

            #ListDataToChuc li:hover {
                background-color: #F4F3F3;
                cursor: pointer;
            }

            #ListDataToChuc li img {
                margin: 5px;
            }

    /* item list */

    .OptionToChuc {
        display: none;
        width: 100%;
        max-width: calc(50% - 28px);
        box-shadow: 0 6px 12px rgba(0,0,0,.175);
        border: 1px solid rgba(0,0,0,.15);
        border-radius: 5px;
        position: absolute;
        z-index: 1;
        display: block;
        background: white;
    }

    @@media (max-width: 1200px) and (min-width: 901px) {
        .OptionToChuc {
            max-width: calc(50% - 28px) !important;
        }
    }

    @@media (max-width: 900px) and (min-width: 701px) {
        .OptionToChuc {
            max-width: calc(50% - 28px) !important;
        }
    }

    @@media (max-width: 700px) {
        .OptionToChuc {
            max-width: calc(100% - 40px) !important;
        }
    }

    .open {
        display: show !important;
    }

    .btn-select {
        width: 100%;
        height: auto;
        min-height: 30px;
        border-radius: 4px 0 0 4px;
        background-color: #fff;
        border: 1px solid #ccc;
        text-align: left;
    }

        .btn-select li {
            list-style: none;
            float: left;
            padding-bottom: 0px;
            width: 100%;
        }

        .btn-select:hover li {
            margin-left: 0px;
        }

        .btn-select:hover {
            background-color: #F4F3F3;
            border: 1px solid transparent;
            box-shadow: inset 0 0px 0px 1px #ccc;
        }

        .btn-select:focus {
            outline: none;
        }

    .opImg {
        display: inline-block;
        height: 50px;
        width: 50px;
        background-color: aquamarine;
        line-height: 50px;
        text-align: center;
        border-radius: 50%;
        color: white;
        font-weight: bold;
        font-size: 25px !important;
        min-width: 50px;
    }

    .opInfo {
        padding-left: 10px;
    }

    .listOption {
        background-color: white;
        height: 300px;
        overflow-y: scroll;
    }

    .text-diachi {
        width: 100%;
        display: -webkit-box;
        -webkit-box-orient: vertical;
        -webkit-line-clamp: 1;
        overflow: hidden;
    }

    .lang-select {
        display: flex;
    }

    .opInfo.Chon {
        text-align: center;
        width: 100%;
    }
</style>
<style>
    .ace-file-multiple .ace-file-container.selected .ace-file-name .ace-icon {
        margin-right: 12px !important;
    }

    .ace-file-name:not(.large) {
        width: 100% !important;
    }

    .btn-del-item {
        float: right;
        background-color: red !important;
        z-index: 1;
        border-radius: 50%;
    }

    .ace-file-multiple .ace-file-container .ace-file-name.large:after {
        background-color: #fff;
        color: #000;
    }

    .ace-file-multiple .ace-file-container .ace-file-name.large {
        border-bottom: 1px solid #ffffff;
        border: 1px dashed #d2d0d0;
    }

    .ace-file-multiple .ace-file-container:before {
        font-size: 14px;
    }

    .ace-file-multiple .ace-file-container .ace-file-name.large {
        width: 24%;
        float: left;
        height: 180px;
    }

        .ace-file-multiple .ace-file-container .ace-file-name.large img {
            width: 100% !important;
            height: 148px !important;
            background-size: contain;
        }

    #XemDinhKemChuKy_CauLD {
        position: absolute;
        right: 10px;
        top: 10px;
        display: none;
    }

    #imgHienThiKyTen:hover #XemDinhKemChuKy_CauLD {
        display: block;
        color: var(--tblr-btn-hover-bg);
        cursor: pointer;
    }

        #imgHienThiKyTen:hover #XemDinhKemChuKy_CauLD > i {
            color: var(--tblr-primary) !important;
        }

    .MoTa_CT {
        width: 720px;
        height: 380px;
        background-size: contain; /* Đảm bảo hình ảnh được thu nhỏ hoặc phóng to để vừa khít */
        background-repeat: no-repeat; /* Tránh lặp lại hình ảnh */
        background-position: center; /* Đặt hình ảnh vào giữa */
    }
</style>
@* Modal thêm mới *@
<div id="mdThemMoiThuThapCau_us" class="modal modal-blur fade" data-backdrop="static">
    <div class="modal-dialog modal-dialog-centered modal-xl" role="document" style="margin: 0;max-width:100%">
        <div class="modal-content" style="border-radius: unset;">
            <div class="modal-header nts-modal" style="background: unset;color: #000;border-bottom: unset;">
                <h5 id="lblTieuDeThemMoi1_us" class="modal-title text-bold" style="font-weight:bold;">Thu thập thông tin Nhu cầu tuyển dụng lao động của người sử dụng lao động</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" style="color: #000 !important;font-weight: bold;"> &times;</button>
            </div>
            <div class="modal-body" style="background: white;">
                <div class="row">
                    <div class="col-md-9">
                        <div class="box-shadow-primary" style="padding: 10px; border-radius: 4px; height: 100%;">
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="line-modal">
                                        <div class="text-line-modal"><div class="text-line">Thông tin chung</div></div>
                                    </div>
                                </div>
                            </div>
                            @* Row 1 *@
                            <div class="row">
                                <div class="col-lg-4">
                                    <div class="mb-3">
                                        <label class="form-label" for="NgayThuThap_us">Ngày thu thập</label>
                                        <input type="text" class="form-control date-picker" id="NgayThuThap_us" autocomplete="off" required>
                                    </div>
                                </div>
                                <div class="col-lg-8">
                                    <div id="n"></div>
                                    <label class="form-label" for="ToChucID_ChuHo" id="lbToChucID_ChuHo">
                                        Tổ chức
                                        <i style="color: blue;cursor:pointer; display:none" class="fa fa-info-circle" aria-hidden="true" id="LichSuDangKy"></i>
                                    </label>
                                    <select class="vodiapickerDT" id="ToChucID_ChuHo" required>
                                    </select>
                                    <div class="lang-select">
                                        <button class="btn-select" value="" id="SelectToChuc_US"></button>
                                        <span class="input-group-text cursor-pointer" style="border-radius: 0 4px 4px 0px;" id="HienThiTatCaToChuc"><i class="fa-solid fa-ellipsis" style="color:var(--tbl-btn-luuvadong)"></i></span>
                                        <div class="OptionToChuc" style=" z-index: 10000000000000; margin-top: 30px;">
                                            <ul id="ListDataToChuc" class="listOption" style=" background-color: white;margin-bottom: 4px;"></ul>
                                            <span id="btnThemNhanhToChuc" style="display: flex; width: fit-content; margin: auto; margin-bottom: 4px; cursor: pointer;" class="badge bg-green"> <i class="fa fa-plus"></i>&nbsp;Thêm mới</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            @* Row 2 *@
                            <div class="row">
                                <div class="col-lg-8">
                                    <div class="mb-3">
                                        <label class="form-label" for="TenKCN_CLD">Tên KCN/KTT</label>
                                        <input type="text" class="form-control" id="TenKCN_CLD_CLD" autocomplete="off" required>
                                    </div>
                                </div>
                                <div class="col-lg-4">
                                    <div class="mb-3">
                                        <label class="form-label" for="NamTrongKCN_us_CLD">&nbsp;</label>
                                        <label class="form-check" style="margin: 5px 0;">
                                            <input class="form-check-input" type="checkbox" id="NamTrongKCN_us_CLD">
                                            <span class="form-check-label">Nằm trong KCN/KKT</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            @* Row 3 *@
                            <div class="row">
                                <div class="col-lg-4">
                                    <div class="mb-3">
                                        <label class="form-label" for="MaSoThue_us_CLD">Số ĐKKD/Mã số thuế</label>
                                        <input list="SoCCCD_list" class="form-control" id="MaSoThue_us_CLD" required>
                                    </div>
                                </div>
                                <div class="col-lg-4">
                                    <div class="mb-3">
                                        <label class="form-label" for="TenNguoiSDLD_us_CLD">Tên người sử dụng lao động</label>
                                        <input type="text" class="form-control" id="TenNguoiSDLD_us_CLD" autocomplete="off" required>
                                    </div>
                                </div>
                                <div class="col-lg-4">
                                    <div class="mb-3">
                                        <label class="form-label" for="SoCCCD_us_CLD">Số CCCD/CMND/Mã định danh</label>
                                        <input type="text" class="form-control" id="SoCCCD_us_CLD" autocomplete="off" onkeypress="return isNumberKey(event);">
                                    </div>
                                </div>
                            </div>
                            @* Row 4 *@
                            <div class="row">
                                <div class="col-lg-4">
                                    <div class="mb-3">
                                        <label class="form-label" for="LoaiHinhDNID_us_CLD">Loại hình doanh nghiệp</label>
                                        <select class="form-control" id="LoaiHinhDNID_us_CLD" tabindex="0" data-dropdown-parent="#mdThemMoiThuThapCau_us">
                                        </select>
                                    </div>
                                </div>
                                <div class="col-lg-4">
                                    <div class="mb-3">
                                        <label class="form-label" for="TinhTrangHDKTID_us_CLD">Tình trạng hoạt động</label>
                                        <select class="form-control" id="TinhTrangHDKTID_us_CLD" tabindex="0" data-dropdown-parent="#mdThemMoiThuThapCau_us" required>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-lg-4">
                                    <div class="mb-3">
                                        <label class="form-label" for="NgayHoatDong_us_CLD">Ngày hoạt động</label>
                                        <input type="text" class="form-control date-picker" id="NgayHoatDong_us_CLD" autocomplete="off">
                                    </div>
                                </div>
                            </div>
                            @* Row 5 *@
                            <div class="row">
                                <div class="col-lg-4">
                                    <div class="mb-3">
                                        <label class="form-label" for="NganhNgheChinh_us_CLD">Ngành nghề kinh doanh chính</label>
                                        <select class="form-control" id="NganhNgheChinh_us_CLD" tabindex="0" data-dropdown-parent="#mdThemMoiThuThapCau_us" multiple>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-lg-4">
                                    <div class="mb-3">
                                        <label class="form-label" for="SoDienThoai_us_CLD">Số điện thoại</label>
                                        <input type="text" class="form-control" id="SoDienThoai_us_CLD">
                                    </div>
                                </div>
                                <div class="col-lg-4">
                                    <div class="mb-3">
                                        <label class="form-label" for="Email_us_CLD">Email</label>
                                        <input type="email" class="form-control" id="Email_us_CLD">
                                    </div>
                                </div>
                            </div>
                            @* Row 6 *@
                            <div class="row">
                                <div class="col-lg-4">
                                    <div class="mb-3">
                                        <label for="TinhID_us_CLD" class="form-label">Tỉnh/Thành phố</label>
                                        <select class="form-control input-sm" id="TinhID_us_CLD" tabindex="0" data-dropdown-parent="#mdThemMoiThuThapCau_us" required></select>
                                    </div>
                                </div>
                                <div class="col-lg-4">
                                    <div class="mb-3">
                                        <label for="HuyenID_us_CLD" class="form-label">Quận/Huyện</label>
                                        <select class="form-control input-sm" id="HuyenID_us_CLD" tabindex="0" data-dropdown-parent="#mdThemMoiThuThapCau_us" required></select>
                                    </div>
                                </div>
                                <div class="col-lg-4">
                                    <div class="mb-3">
                                        <label for="XaID_us_CLD" class="form-label">Phường/Xã</label>
                                        <select class="form-control input-sm" id="XaID_us_CLD" tabindex="0" data-dropdown-parent="#mdThemMoiThuThapCau_us" required></select>
                                    </div>
                                </div>
                            </div>
                            @* Row 7 *@
                            <div class="row">
                                <div class="col-lg-4">
                                    <div class="mb-3">
                                        <label for="ThonID_us_CLD" class="form-label">Thôn/Xóm</label>
                                        <select class="form-control input-sm" id="ThonID_us_CLD" tabindex="0" data-dropdown-parent="#mdThemMoiThuThapCau_us"></select>
                                    </div>
                                </div>
                                <div class="col-lg-8">
                                    <div class="mb-3">
                                        <label for="" class="form-label">&nbsp;</label>

                                        <div class="input-group mb-3">
                                            <input type="text" class="form-control" placeholder="Số nhà" autocomplete="off" id="SoNha_us_CLD" style="min-width: 20%;">
                                            <span class="input-group-text" style="min-width: 80%;" id="DiaChi_us_CLD">
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            @* Row 8 *@
                            <div class="row">
                                <div class="col-lg-4">
                                    <div class="mb-3">
                                        <label for="QuyMoSDLD_us_CLD" class="form-label">Quy mô sử dụng lao động</label>
                                        <select class="form-control input-sm" id="QuyMoSDLD_us_CLD" tabindex="0" data-dropdown-parent="#mdThemMoiThuThapCau_us"></select>
                                    </div>
                                </div>
                                <div class="col-lg-8">
                                    <div class="mb-3">
                                        <label for="MatHangChinh_us" class="form-label">Mặt hàng/sản phẩm dịch vụ chính</label>
                                        <input type="text" class="form-control" id="MatHangChinh_us">
                                    </div>
                                </div>
                            </div>
                            @* Row 9 *@
                            <div class="row">
                                <div class="col-lg-12">
                                    <div class="mb-3">
                                        <label for="NoiDungTT_us_CLD" class="form-label">Nội dung thu thập</label>
                                        <textarea class="form-control" id="NoiDungTT_us_CLD" rows="5" maxlength="500"></textarea>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div style="display: flex; align-items: center; justify-content: space-between">
                                    <div class="col-md-6" style="display: flex; align-items: center">
                                    </div>
                                    <div class="col-md-6">
                                        <div style="float:right;text-align: right">
                                            <a href="#" id="btnTiepTuc_PhieuThuThap" class="btn btn-success btn-luuvadong ms-auto">
                                                <img src="~/Images/next-step.svg" />
                                                &ensp;Tiếp tục (F9)
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    @*----------------------------------------*@
                    <div class="col-md-3">
                        <div class="box-shadow-primary" style="padding: 10px; border-radius: 4px; height: 100%;">
                            <div class="row mt-2 box-hdsd" style="background-color: white; border-radius: 8px; padding: 10px; height:100%;">
                                <ul class="steps steps-counter steps-vertical">
                                    <h2 style="margin-bottom:0px">CÁC BƯỚC THỰC HIỆN</h2>
                                    <li class="step-item active">
                                        <div class="h4 m-0">Thông tin chung</div>
                                        <div class="text-dark">Nhập các thông tin chung như: Ngày thu thập, nội dung thu thập, tổ chức thu thập,...</div>
                                        <img src="/Images/Nen.png" style="max-width: 43%;">
                                    </li>
                                    <li class="step-item">
                                        <div class="h4 m-0">Thông tin lao động tổ chức</div>
                                        <div class="text-dark">Cập nhật các thông tin lao động hiện có của tổ chức như: Tổng số lao động đang làm việc, tiền lương,...</div>
                                        <img src="/Images/Nen2.png" style="max-width: 43%; ">
                                    </li>
                                    <li class="step-item">
                                        <div class="h4 m-0">Nhu cầu tuyển dụng</div>
                                        <div class="text-dark">
                                            Cập nhật các thông tin nhu cầu tuyển dụng lao động chia theo từng ngành, nghề
                                        </div>
                                        <img src="/Images/Nen3.png" style="max-width: 43%; ">
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


@* Modal bước 2 *@
<div id="mdThemMoiThuThapCau_Buoc2_us" class="modal modal-blur fade" data-backdrop="static">
    <div class="modal-dialog modal-dialog-centered modal-xl" role="document" style="margin: 0;max-width: 100%">
        <div class="modal-content" style="border-radius: unset;">
            <div class="modal-header nts-modal" style="background: unset;color: #000;border-bottom: unset;">
                <h5 id="lblTieuDeThemMoi2_us" class="modal-title text-bold" style="font-weight:bold;">Thu thập thông tin Nhu cầu tuyển dụng lao động của người sử dụng lao động</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" style="color: #000 !important;font-weight: bold;"> &times;</button>
            </div>
            <div class="modal-body" style="background: white;">
                <div class="row">
                    <div class="col-md-9">
                        <div class="box-shadow-primary" style="padding: 10px; border-radius: 4px; height: 100%;">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="box-img">
                                        <img src="~/Images/Nen.jpg" />
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="gird-data">
                                        <div class="row">
                                            <div class="col-md-12">
                                                <div class="line-modal">
                                                    <div class="text-line-modal"><div class="text-line" style="width: 585px;">Thông tin người lao động đang làm việc</div></div>
                                                </div>
                                            </div>
                                            <div class="col-md-12">
                                                <div class="box-border-cauld mb-4">
                                                    <div class="row">
                                                        <div class="col-md-1" style="display: flex;align-items: center;justify-content: center;">
                                                            <i class="fa-solid fa-circle-info" style=" font-size: 24px; color: var(--tblr-color-header);"></i>
                                                        </div>
                                                        <div class="col-md-11">
                                                            Điều tra viên thu thập cập nhật thông tin số lượng người lao động đang làm việc hiện có tại tổ chức đang thu thập theo từng chỉ tiêu bên dưới
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-12 mb-4">
                                                <div id="Grid_ChiTieuThuThap_us"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div style="display: flex; align-items: center; justify-content: space-between">
                                    <div class="col-md-6" style="display: flex; align-items: center">
                                    </div>
                                    <div class="col-md-6">
                                        <div style="float:right;text-align: right">
                                            <a href="#" id="btnQuayLaiBuoc1_us" class="btn btn-success  ms-auto">
                                                <img src="~/Images/icon_QuayLai.svg" />
                                                &ensp;Quay lại (F8)
                                            </a>
                                            <a href="#" id="btnTiepTuc_NhuCauTuyenDung" class="btn btn-success btn-luuvadong ms-auto">
                                                <img src="~/Images/next-step.svg" alt="Alternate Text" />
                                                &ensp;Tiếp tục (F9)
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    @*----------------------------------------*@
                    <div class="col-md-3">
                        <div class="box-shadow-primary" style="padding: 10px; border-radius: 4px; height: 100%;">
                            <div class="row mt-2 box-hdsd" style="background-color: white; border-radius: 8px; padding: 18px 12px 30px 20px; height:100%;">
                                <ul class="steps steps-counter steps-vertical">
                                    <h2 style="margin-bottom:0px">CÁC BƯỚC THỰC HIỆN</h2>
                                    <li class="step-item " onclick="ChuyenModalBuoc1_us()">
                                        <div class="h4 m-0">Thông tin chung</div>
                                        <div class="text-dark">Nhập các thông tin chung như: Ngày thu thập, nội dung thu thập, tổ chức thu thập,...</div>
                                        <img src="/Images/Nen.png" style="max-width: 43%;">
                                    </li>
                                    <li class="step-item active" onclick="ChuyenModalBuoc2_us()">
                                        <div class="h4 m-0">Thông tin lao động tổ chức</div>
                                        <div class="text-dark">Cập nhật các thông tin lao động hiện có của tổ chức như: Tổng số lao động đang làm việc, tiền lương,...</div>
                                        <img src="/Images/Nen2.png" style="max-width: 43%; ">
                                    </li>
                                    <li class="step-item" onclick="ChuyenModalBuoc1_us()">
                                        <div class="h4 m-0">Nhu cầu tuyển dụng</div>
                                        <div class="text-dark">
                                            Cập nhật các thông tin nhu cầu tuyển dụng lao động chia theo từng ngành, nghề
                                        </div>
                                        <img src="/Images/Nen3.png" style="max-width: 43%; ">
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


@* Modal bước 3 *@
<div id="mdThemMoiThuThapCau_Buoc3_us" class="modal modal-blur fade" data-backdrop="static">
    <div class="modal-dialog modal-dialog-centered modal-xl" role="document" style="margin: 0; max-width: 100%">
        <div class="modal-content" style="border-radius: unset;">
            <div class="modal-header nts-modal" style="background: unset;color: #000;border-bottom: unset;">
                <h5 id="lblTieuDeThemMoi3_us" class="modal-title text-bold" style="font-weight:bold;">Thu thập thông tin Nhu cầu tuyển dụng lao động của người sử dụng lao động</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" style="color: #000 !important;font-weight: bold;"> &times;</button>
            </div>
            <div class="modal-body" style="background: white;">
                <div class="row">
                    <div class="col-md-9">
                        <div class="box-shadow-primary" style="padding: 10px; border-radius: 4px; height: 100%;">
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="gird-data">
                                        <div class="row">
                                            <div class="col-md-12">
                                                <div class="line-modal">
                                                    <div class="text-line-modal"><div class="text-line" style="width: 285px;">Nhu cầu tuyển dụng lao động</div></div>
                                                </div>
                                            </div>
                                            <div class="col-md-12">
                                                <div class="box-border-cauld mb-4">
                                                    <div class="row" style="width:100%">
                                                        <div class="col-md-1" style="display: flex;align-items: center;justify-content: center;">
                                                            <i class="fa-solid fa-circle-info" style=" font-size: 24px; color: var(--tblr-color-header);"></i>
                                                        </div>
                                                        <div class="col-md-11">
                                                            Điều tra viên thu thập cập nhật thông tin nhu cầu tuyển dụng lao động trong 6 tháng tới chia theo từng ngành nghề cần tuyển dụng
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-12 mb-4">
                                                <div id="Grid_MaNghe_us"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            @* ---------------------------------Đính kèm----------------------------------- *@
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="line-modal">
                                        <div class="text-line-modal"><div class="text-line" style="width: 490px;">Đính kèm (*.DOC, *.PDF, *.PNG, *.JPG, *.JPEG)</div></div>
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <input type="file" id="DinhKem_CauLD_us" multiple accept=".pdf, .png, .jpg, .jpeg">
                                </div>
                            </div>
                            @* ---------------------------------Ký tên----------------------------------- *@
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="line-modal">
                                        <div class="text-line-modal"><div class="text-line">Ký tên</div></div>
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <div class="row">
                                        <div class="col-md-1" style="position: relative;">
                                            <div class="box-input">
                                                <button class="btn btn-warning mb-2" style="width: 80px" id="VeChuKy_us">
                                                    <img src="~/Images/butve.svg" alt="Ký tên" /> &nbsp; Vẽ
                                                </button>
                                                <button class="btn btn-primary mb-2" style="width: 80px;" id="TaiChuKy">
                                                    <img src="~/Images/tailen.svg" alt="Tải ảnh lên" />&nbsp; Tải lên
                                                </button>
                                                <button class="btn btn-primary mb-2" style="width: 80px; display: none;" id="XoaChuKy">
                                                    <img src="~/Images/tailen.svg" alt="Tải ảnh lên" />&nbsp; Xóa
                                                </button>
                                                <div class="col-md-12" style="visibility:hidden">
                                                    <input type="text" class="form-control">
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <div class="box-img-kyten mb-2" id="imgHienThiKyTen" style="position:relative; background-size: contain; background-repeat: no-repeat; background-position: center;">
                                                        <div id="XemDinhKemChuKy_CauLD" title="Xem đính kèm chữ ký">
                                                            <i class="fa-solid fa-eye" style="font-size:20px;display:none;" id="icon_XemDinhKemChuKy_CauLD"></i>
                                                        </div>
                                                        <input type="hidden" id="txtDuongDanFileChuKy" value="" required />
                                                        <input type="file" id="fileVB_ChuKy_CauLD" class="d-none" accept=".jpg,.jpeg,.png" />
                                                    </div>
                                                </div>
                                                <div class="col-md-12">
                                                    <input type="text" class="form-control" id="KyTen_us" style="text-transform:uppercase;">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div style="display: flex; align-items: center; justify-content: space-between">
                                    <div class="col-md-6" style="display: flex; align-items: center">
                                    </div>
                                    <div class="col-md-6">
                                        <div style="float:right;text-align: right">
                                            <a href="#" id="btnQuayLaiBuoc2_us" class="btn btn-success ms-auto">
                                                <img src="~/Images/icon_QuayLai.svg" />
                                                &ensp;Quay lại (F8)
                                            </a>
                                            <a href="#" id="btnKetThuc_us" class="btn btn-success btn-luuvadong ms-auto">
                                                <img src="~/Images/icon_KetThuc.svg" alt="Alternate Text" />
                                                &ensp;Kết thúc (F9)
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    @*----------------------------------------*@
                    <div class="col-md-3">
                        <div class="box-shadow-primary" style="padding: 10px; border-radius: 4px; height: 100%;">
                            <div class="row mt-2 box-hdsd" style="background-color: white; border-radius: 8px; padding: 18px 12px 30px 20px; height:100%;">
                                <ul class="steps steps-counter steps-vertical">
                                    <h2 style="margin-bottom:0px">CÁC BƯỚC THỰC HIỆN</h2>
                                    <li class="step-item " onclick="ChuyenModalBuoc1_us()">
                                        <div class="h4 m-0">Thông tin chung</div>
                                        <div class="text-dark">Nhập các thông tin chung như: Ngày thu thập, nội dung thu thập, tổ chức thu thập,...</div>
                                        <img src="/Images/Nen.png" style="max-width: 43%;">
                                    </li>
                                    <li class="step-item " onclick="ChuyenModalBuoc2_us()">
                                        <div class="h4 m-0">Thông tin lao động tổ chức</div>
                                        <div class="text-dark">Cập nhật các thông tin lao động hiện có của tổ chức như: Tổng số lao động đang làm việc, tiền lương,...</div>
                                        <img src="/Images/Nen2.png" style="max-width: 43%; ">
                                    </li>
                                    <li class="step-item active" onclick="ChuyenModalBuoc3_us()">
                                        <div class="h4 m-0">Nhu cầu tuyển dụng</div>
                                        <div class="text-dark">
                                            Cập nhật các thông tin nhu cầu tuyển dụng lao động chia theo từng ngành, nghề
                                        </div>
                                        <img src="/Images/Nen3.png" style="max-width: 43%; ">
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>

@Html.Partial("KyTen")
@* Modal xem chi tiet ghi chu *@
<div id="mdXemDinhKemChuKy" class="modal modal-blur fade" tabindex="-1" aria-modal="true" role="dialog" data-bs-backdrop="static">
    <div class="modal-dialog modal-dialog-top" role="document" style="max-width: 740px !important;">
        <div class="modal-content">
            <div class="modal-header nts-modal">
                <h5 id="tieuDeModaXemChuKyCLD" class="modal-title text-bold">Đính kèm chữ ký</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"> &times;</button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="form-group">

                        <div class="col-md-12" id="DinhKemChuLy_CLD">
                            <p class="MoTa_CT"></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    var textDiaChi_defaut = "";
    $(function () {
        setTimeout(() => {
            LoadDataComBoCauLaoDong();
        }, 300);
    });
    $(document).ready(function () {
        $('#SoDienThoai_us_CLD').on('input', function () {
            formatPhoneNumberNhap(this);
        });

        //Định dạng nhập xxxx.xxx.xxx cho số điện thoại
        $('#SoDienThoai_us_CLD').on('input', function () {
            formatPhoneNumberNhap(this);
        });

        // Restrict input to numbers only
        $('#SoDienThoai_us_CLD').on('keydown', function (event) {
            // Allow control keys (backspace, delete, tab, etc.)
            if (event.ctrlKey || event.metaKey || [8, 46, 37, 38, 39, 40, 9, 27, 13].includes(event.keyCode)) {
                return;
            }
            // Check if event.key is defined and allow only numeric input
            if (event.key && event.key.match(/[\d]/)) {
                return;
            }
            // Prevent default action if not allowed
            event.preventDefault();
        });
    });
    function LoadDataComBoCauLaoDong() {
        NTS.loadDataCombo({
            name: '#LoaiHinhDNID_us_CLD',
            ajaxUrl: '/DanhMuc/DungChung/GetComBo_LoaiHinhNoiLV',
            columns: 1,
            indexValue: 0,
            indexText: 1,
            textShowTatCa: '-Chọn-',
            showTatCa: !0,
        });
        NTS.loadDataCombo({
            name: '#TinhTrangHDKTID_us_CLD',
            ajaxUrl: '/DanhMuc/DungChung/GetComBo_TinhTrangTGHDKT',
            columns: 1,
            indexValue: 0,
            indexText: 1,
            textShowTatCa: '-Chọn-',
            showTatCa: !0,
            indexDefault: 2,
        });
        NTS.loadDataCombo({
            name: '#NganhNgheChinh_us_CLD',
            ajaxUrl: '/DanhMuc/DungChung/GetComBo_NganhSanXuatKinhDoanh',
            columns: 1,
            indexValue: 0,
            indexText: 1,
            textShowTatCa: '-Chọn-',
            showTatCa: !0,
        });
        NTS.loadDataCombo({
            name: '#QuyMoSDLD_us_CLD',
            ajaxUrl: '/DanhMuc/DungChung/GetComBo_QuyMoLaoDong',
            columns: 1,
            indexValue: 0,
            indexText: 1,
            textShowTatCa: '-Chọn-',
            showTatCa: !0,
        });
        NTS.loadDataCombo({
            name: '#TinhID_us_CLD',
            ajaxUrl: '/DanhMuc/DungChung/GetDiaBanHCTinh_Combo',
            columns: 2,
            indexValue: 0,
            indexText1: 2,
            textShowTatCa: '-Chọn-',
            showTatCa: !0,
            //indexDefault: 3,
        });
        NTS.loadDataCombo({
            name: '#HuyenID_us_CLD',
            ajaxUrl: '/DanhMuc/DungChung/GetDiaBanHCHuyen_Combo',
            ajaxParam: { id: '' },
            columns: 2,
            indexValue: 0,
            indexText1: 2,
            textShowTatCa: '-Chọn-',
            showTatCa: !0,
            //indexDefault: 3,
        });
        NTS.loadDataCombo({
            name: '#XaID_us_CLD',
            ajaxUrl: '/DanhMuc/DungChung/GetDiaBanHCXa_Combo',
            ajaxParam: { id: '' },
            columns: 2,
            indexValue: 0,
            indexText1: 2,
            textShowTatCa: '-Chọn-',
            showTatCa: !0,
            //indexDefault: 3,
        });
        NTS.loadDataCombo({
            name: '#ThonID_us_CLD',
            ajaxUrl: '/DanhMuc/DungChung/GetDiaBanHCThon_Combo',
            ajaxParam: { id: '' },
            columns: 2,
            indexValue: 0,
            indexText1: 2,
            textShowTatCa: '-Chọn-',
            showTatCa: !0,
            //indexDefault: 3,
        });
    }

    //-----------------------Change Hộ khẩu thường trú trong form thêm, sửa-------------------------//
    $(document).on('change', '#TinhID_us_CLD', function () {
        NTS.loadDataCombo({
            name: '#HuyenID_us_CLD',
            ajaxUrl: '/DanhMuc/DungChung/GetDiaBanHCHuyen_Combo',
            ajaxParam: { id: $('#TinhID_us_CLD').value() },
            columns: 2,
            indexValue: 0,
            indexText1: 2,
            textShowTatCa: '-Chọn-',
            showTatCa: !0
        });
        NTS.loadDataCombo({
            name: '#XaID_us_CLD',
            ajaxUrl: '/DanhMuc/DungChung/GetDiaBanHCXa_Combo',
            ajaxParam: { id: '' },
            indexValue: 0,
            indexText: 2,
            textShowTatCa: '-Chọn-',
            showTatCa: !0
        });
        NTS.loadDataCombo({
            name: '#ThonID_us_CLD',
            ajaxUrl: '/DanhMuc/DungChung/GetDiaBanHCThon_Combo',
            ajaxParam: { id: '' },
            indexValue: 0,
            indexText: 2,
            textShowTatCa: '-Chọn-',
            showTatCa: !0
        });
        //Change địa chỉ
        var DiaChi = $('#SoNha_us_CLD').value().trim();
        if (DiaChi != '') {
            DiaChi = DiaChi + ', ';
        }
        var txtTinh = $('#TinhID_us_CLD');
        var txtHuyen = $('#HuyenID_us_CLD');
        var txtXa = $('#XaID_us_CLD');
        var txtThon = $('#ThonID_us_CLD');

        if (txtTinh.select2('data')[0].text1 != '-Chọn-') {
            if (txtHuyen.select2('data')[0].text1 != '-Chọn-') {
                if (txtXa.select2('data')[0].text1 != '-Chọn-') {
                    if (txtThon.select2('data')[0].text1 != '-Chọn-') {
                        $('#DiaChi_us_CLD').html(DiaChi + txtThon.select2('data')[0].text1 + ', ' + txtXa.select2('data')[0].text1 + ', ' + txtHuyen.select2('data')[0].text1 + ', ' + txtTinh.select2('data')[0].text1);
                    } else {
                        $('#DiaChi_us_CLD').html(DiaChi + txtXa.select2('data')[0].text1 + ', ' + txtHuyen.select2('data')[0].text1 + ', ' + txtTinh.select2('data')[0].text1);
                    }
                } else {
                    $('#DiaChi_us_CLD').html(DiaChi + txtHuyen.select2('data')[0].text1 + ', ' + txtTinh.select2('data')[0].text1);
                }
            } else {
                $('#DiaChi_us_CLD').html(DiaChi + txtTinh.select2('data')[0].text1);
            }
        } else {
            if (DiaChi != '') {
                $('#DiaChi_us_CLD').html(DiaChi);
            }
            else {
                $('#DiaChi_us_CLD').html(textDiaChi_defaut);
            }

        }
    });
    $(document).on('change', '#HuyenID_us_CLD', function () {
        NTS.loadDataCombo({
            name: '#XaID_us_CLD',
            ajaxUrl: '/DanhMuc/DungChung/GetDiaBanHCXa_Combo',
            ajaxParam: { id: $('#HuyenID_us_CLD').value() },
            columns: 2,
            indexValue: 0,
            indexText1: 2,
            textShowTatCa: '-Chọn-',
            showTatCa: !0
        });
        NTS.loadDataCombo({
            name: '#ThonID_us_CLD',
            ajaxUrl: '/DanhMuc/DungChung/GetDiaBanHCThon_Combo',
            ajaxParam: { id: '' },
            indexValue: 0,
            indexText: 2,
            textShowTatCa: '-Chọn-',
            showTatCa: !0
        });
        //Change địa chỉ
        var DiaChi = $('#SoNha_us_CLD').value().trim();
        if (DiaChi != '') {
            DiaChi = DiaChi + ', ';
        }
        var txtTinh = $('#TinhID_us_CLD');
        var txtHuyen = $('#HuyenID_us_CLD');
        var txtXa = $('#XaID_us_CLD');
        var txtThon = $('#ThonID_us_CLD');

        if (txtTinh.select2('data')[0].text1 != '-Chọn-') {
            if (txtHuyen.select2('data')[0].text1 != '-Chọn-') {
                if (txtXa.select2('data')[0].text1 != '-Chọn-') {
                    if (txtThon.select2('data')[0].text1 != '-Chọn-') {
                        $('#DiaChi_us_CLD').html(DiaChi + txtThon.select2('data')[0].text1 + ', ' + txtXa.select2('data')[0].text1 + ', ' + txtHuyen.select2('data')[0].text1 + ', ' + txtTinh.select2('data')[0].text1);
                    } else {
                        $('#DiaChi_us_CLD').html(DiaChi + txtXa.select2('data')[0].text1 + ', ' + txtHuyen.select2('data')[0].text1 + ', ' + txtTinh.select2('data')[0].text1);
                    }
                } else {
                    $('#DiaChi_us_CLD').html(DiaChi + txtHuyen.select2('data')[0].text1 + ', ' + txtTinh.select2('data')[0].text1);
                }
            } else {
                $('#DiaChi_us_CLD').html(DiaChi + txtTinh.select2('data')[0].text1);
            }
        } else {
            if (DiaChi != '') {
                $('#DiaChi_us_CLD').html(DiaChi);
            } else {
                $('#DiaChi_us_CLD').html(textDiaChi_defaut);
            }

        }
    });
    $(document).on('change', '#XaID_us_CLD', function () {
        NTS.loadDataCombo({
            name: '#ThonID_us_CLD',
            ajaxUrl: '/DanhMuc/DungChung/GetDiaBanHCThon_Combo',
            ajaxParam: { id: $('#XaID_us_CLD').value() },
            columns: 2,
            indexValue: 0,
            indexText1: 2,
            textShowTatCa: '-Chọn-',
            showTatCa: !0
        });
        //Change địa chỉ
        var DiaChi = $('#SoNha_us_CLD').value().trim();
        if (DiaChi != '') {
            DiaChi = DiaChi + ', ';
        }
        var txtTinh = $('#TinhID_us_CLD');
        var txtHuyen = $('#HuyenID_us_CLD');
        var txtXa = $('#XaID_us_CLD');
        var txtThon = $('#ThonID_us_CLD');

        if (txtTinh.select2('data')[0].text1 != '-Chọn-') {
            if (txtHuyen.select2('data')[0].text1 != '-Chọn-') {
                if (txtXa.select2('data')[0].text1 != '-Chọn-') {
                    if (txtThon.select2('data')[0].text1 != '-Chọn-') {
                        $('#DiaChi_us_CLD').html(DiaChi + txtThon.select2('data')[0].text1 + ', ' + txtXa.select2('data')[0].text1 + ', ' + txtHuyen.select2('data')[0].text1 + ', ' + txtTinh.select2('data')[0].text1);
                    } else {
                        $('#DiaChi_us_CLD').html(DiaChi + txtXa.select2('data')[0].text1 + ', ' + txtHuyen.select2('data')[0].text1 + ', ' + txtTinh.select2('data')[0].text1);
                    }
                } else {
                    $('#DiaChi_us_CLD').html(DiaChi + txtHuyen.select2('data')[0].text1 + txtTinh.select2('data')[0].text1);
                }
            } else {
                $('#DiaChi_us_CLD').html(DiaChi + txtTinh.select2('data')[0].text1);
            }
        } else {
            if (DiaChi != '') {
                $('#DiaChi_us_CLD').html(DiaChi);
            } else {
                $('#DiaChi_us_CLD').html(textDiaChi_defaut);
            }

        }
    });
    $(document).on('change', '#ThonID_us_CLD', function () {
        //Change địa chỉ
        var DiaChi = $('#SoNha_us_CLD').value().trim();
        if (DiaChi != '') {
            DiaChi = DiaChi + ', ';
        }
        var txtTinh = $('#TinhID_us_CLD');
        var txtHuyen = $('#HuyenID_us_CLD');
        var txtXa = $('#XaID_us_CLD');
        var txtThon = $('#ThonID_us_CLD');

        if (txtTinh.select2('data')[0].text1 != '-Chọn-') {
            if (txtHuyen.select2('data')[0].text1 != '-Chọn-') {
                if (txtXa.select2('data')[0].text1 != '-Chọn-') {
                    if (txtThon.select2('data')[0].text1 != '-Chọn-') {
                        $('#DiaChi_us_CLD').html(DiaChi + txtThon.select2('data')[0].text1 + ', ' + txtXa.select2('data')[0].text1 + ', ' + txtHuyen.select2('data')[0].text1 + ', ' + txtTinh.select2('data')[0].text1);
                    } else {
                        $('#DiaChi_us_CLD').html(DiaChi + txtXa.select2('data')[0].text1 + ', ' + txtHuyen.select2('data')[0].text1 + ', ' + txtTinh.select2('data')[0].text1);
                    }
                } else {
                    $('#DiaChi_us_CLD').html(DiaChi + txtHuyen.select2('data')[0].text1 + ', ' + txtTinh.select2('data')[0].text1);
                }
            } else {
                $('#DiaChi_us_CLD').html(DiaChi + txtTinh.select2('data')[0].text1);
            }
        } else {
            if (DiaChi != '') {
                $('#DiaChi_us_CLD').html(DiaChi);
            } else {
                $('#DiaChi_us_CLD').html(textDiaChi_defaut);
            }

        }
    });

    //-----------------------Change dia chi--------------------------//
    $('#SoNha_us_CLD').on('input', function () {
        //Change địa chỉ
        var DiaChi = $('#SoNha_us_CLD').value().trim();
        if (DiaChi != '') {
            DiaChi = DiaChi + ', ';
        }
        var txtTinh = $('#TinhID_us_CLD');
        var txtHuyen = $('#HuyenID_us_CLD');
        var txtXa = $('#XaID_us_CLD');
        var txtThon = $('#ThonID_us_CLD');

        if (txtTinh.select2('data')[0].text1 != '-Chọn-') {
            if (txtHuyen.select2('data')[0].text1 != '-Chọn-') {
                if (txtXa.select2('data')[0].text1 != '-Chọn-') {
                    if (txtThon.select2('data')[0].text1 != '-Chọn-') {
                        $('#DiaChi_us_CLD').html(DiaChi + txtThon.select2('data')[0].text1 + ', ' + txtXa.select2('data')[0].text1 + ', ' + txtHuyen.select2('data')[0].text1 + ', ' + txtTinh.select2('data')[0].text1);
                    } else {
                        $('#DiaChi_us_CLD').html(DiaChi + txtXa.select2('data')[0].text1 + ', ' + txtHuyen.select2('data')[0].text1 + ', ' + txtTinh.select2('data')[0].text1);
                    }
                } else {
                    $('#DiaChi_us_CLD').html(DiaChi + txtHuyen.select2('data')[0].text1 + ', ' + txtTinh.select2('data')[0].text1);
                }
            } else {
                $('#DiaChi_us_CLD').html(DiaChi + txtTinh.select2('data')[0].text1);
            }
        } else {
            if (DiaChi != '') {
                $('#DiaChi_us_CLD').html(DiaChi);
            } else {
                $('#DiaChiThuongTru').value(textDiaChi_defaut);
            }

        }

    });

    async function loadMacDinhDiaBanHC_TheoDV() {
        try {
            var DonVi = await NTS.getAjaxAsync('/DanhMuc/DungChung/GetThongTinDonViThaoTac', {});
            DonVi = DonVi.Result;
            if (DonVi != undefined && !$.isEmptyObject(DonVi) && DonVi != '' && DonVi != null) {
                $('#TinhID_us_TC').value(DonVi[0].DiaBanHCID_Tinh);
                $('#HuyenID_us_TC').value(DonVi[0].DiaBanHCID_Huyen);
                $('#XaID_us_TC').value(DonVi[0].DiaBanHCID_Xa);
            }
        } catch (e) {

        }
    }

    function showModalThemMoiThuThapCauLaoDong() {
        $('#mdThemMoiThuThapCau_us').modal('show');
        $('#SelectToChuc_US').html('<li action="chon"><div class="opInfo Chon"><div style="display: flex;justify-content: space-between;align-items: center;">-Chọn tổ chức- <i class="fa-solid fa-caret-down" style="float: right;"></i></div></li>');
        $('#SelectToChuc_US').attr('value', "");
        $('#ToChucID_ChuHo').html("");
        $('#MaToChucUS_CLD').value('');
        resetForm("#mdThemMoiThuThapCau_us");
        NTS.hienNgayHienTaiLenTextbox("NgayThuThap_us");
        $('#TinhTrangHDKTID_us_CLD option:eq(1)').prop('selected', true);
        $('#TinhTrangHDKTID_us_CLD').trigger('change');
        PhanQuyenComBoDiaBan('TinhID_us_CLD', 'HuyenID_us_CLD', 'XaID_us_CLD', 'ThonID_us_CLD');
        loadMacDinhDiaBanHC_TheoDV();
    }


    // Kiểm tra và thay thế giá trị null hoặc "00000000-0000-0000-0000-000000000000" bằng ""
    function replaceNullAndEmptyString(value) {
        if (value === null || value === "00000000-0000-0000-0000-000000000000") {
            return "";
        }
        return value;
    }
    ///-------------------Xu ly luu file dinh kem------------///
    function uploadfileEvent(options) {

        var result;
        var defaults = {
            name: '',
            loaiVB: '',
            type: '',
            thongBaoThanhCong: 'Tải file thành công!',
            hienThongBao: true
        };
        var settings = $.extend(defaults, options);
        if (settings.loaiVB == '' || settings.loaiVB == 'undefined') {
            result = "";
            NTS.canhbao("Bạn chưa cài đặt loại văn bản, vui lòng kiểm ra lại");
            return result;
        }
        else if (settings.name == '' || settings.name == 'undefined' || $(settings.name).length == 0) {
            NTS.canhbao('Không tồn tại control ' + settings.name + ' cho hàm upload');
            return result;
        }
        var fileUpload = $(settings.name).get(0);
        var files = $(fileUpload).data('ace_input_files');
        if (files == undefined) {
            return "";
        }

        var test = new FormData();
        for (var i = 0; i < files.length; i++) {
            if (positionRemoveItiem.includes(i) == false) {
                test.append(files[i].name, files[i]);
            }
        }
        positionRemoveItiem = [];
        var bar = $('.progress-bar');
        var percent = $('.percent');
        var status = $('#status');
        $.ajax({
            url: "/UploadFiles/UploadFiles?loaiVB=" + settings.loaiVB + '&type=' + settings.type,
            type: "POST",
            contentType: false, // Not to set any content header
            processData: false, // Not to process data
            data: test,
            async: false,
            beforeSend: function () {
                NTS.loadding();
            },
            success: function (data) {
                NTS.unloadding();
                if (data != "") {
                    //$('#FileBrowse').find("*").prop("disabled", true);
                    //LoadProgressBar(data); //calling LoadProgressBar function to load the progress bar.
                }
                data = data.replaceAll("\"", "");
                data = data.split('|');
                if (data[0] == "1") {
                    result = data[1];
                    //if (settings.hienThongBao) {
                    //    NTS.thanhcong(settings.thongBaoThanhCong);
                    //}
                }
                else if (data[0] == "0") {
                    result = "";
                    NTS.loi(data[1]);
                }
                else if (data[0] == "-1") {
                    result = "";
                    NTS.loi(data[1]);
                    //setTimeout(function () { window.location.href = "/view/shared/main.aspx" }, 500);
                }
            },
            error: function (err) {
                result = "";
                NTS.loi("Tải file thất bại! Bạn vui lòng kiểm tra lại");
                NTS.unloadding();
            }
            , complete: function (err) {
                NTS.unloadding();
            }
        });
        //reset cac file  vua dua len để tránh trường hợp cập nhật lấy lại các file vừa mới đưa lên
        // Tạo một FileList rỗng
        var emptyFileList = new DataTransfer().files;

        // Gán FileList rỗng vào dữ liệu jQuery
        $($('#DinhKem_CauLD_us').get(0)).data('ace_input_files', emptyFileList);
        return result;
    }

    //----------------------------Đính kèm thu thập cau lao động-----------------------------------//
    $('#DinhKem_CauLD_us').on('change', function () {
        var selectedFiles = this.files;

        // Kiểm tra và xử lý tệp đã chọn ở đây
        for (var i = 0; i < selectedFiles.length; i++) {
            var fileName = selectedFiles[i].name;
            var fileType = fileName.split('.').pop().toLowerCase();

            // Kiểm tra loại tệp
            if (fileType === 'docx' || fileType === 'pdf' || fileType === 'png' || fileType === 'jpg' || fileType === 'jpeg') {
                // Xử lý tệp ở đây nếu đúng định dạng
                console.log('Đã chọn tệp: ' + fileName);
            } else {
                alert('Vui lòng chọn tệp DOC, PDF, PNG, JPG hoặc JPEG.');
                // Xoá tệp không hợp lệ khỏi input (nếu cần)
                ResetDinhKemFile();
            }
        }
    });
    var old_ItemFile = "";
    $('#DinhKem_CauLD_us').ace_file_input({
        style: 'well',
        btn_choose: 'Nhấn để chọn tệp hoặc kéo thả vào đây (Cho phép đính kèm các file có định dạng DOC, PDF, PNG, JPG, JPEG)',
        btn_change: null,
        no_icon: 'ace-icon fa fa-cloud-upload',
        droppable: true,
        thumbnail: 'large',
        allowExt: ["jpeg", "jpg", "png", "gif", "pdf", "docx"]
        , alter_change: function ChangeItem() {
            return false;
        }
        , before_change: function (files, dropped) {
            return true;
        },
        preview_error: function (filename, error_code) {
        }
        , before_remove: function RemoveALl() {
            RemoveAllFileInputAce();
        }
    }).on('change', function () {

        //Trước khi load các file đã tồn tại trước đó cần gắn dấu X trước
        $('.ace-file-name').each(function () {
            // Sử dụng find() để kiểm tra xem có thẻ '<i class="ace-icon fa fa-times XoaFileDinhKem btn-del-item" onclick="return false"></i>' hay không
            var hasIcon = $(this).find('i.ace-icon.fa.fa-times.XoaFileDinhKem.btn-del-item').length > 0;

            // Kiểm tra kết quả và thực hiện các hành động cần thiết
            if (hasIcon) {
                // da ton tai dau X
            } else {
                // khong ton tai dau x
                $('.ace-file-name').append('<i class=" ace-icon fa fa-times  XoaFileDinhKemDT XoaFileDinhKem btn-del-item" onclick="return false"></i>');
            }
        });
        //Load các file đã upload vào db
        if ($(old_ItemFile[0]).attr("data-title") != 'No File ...') {
            $('.ace-file-container').append(old_ItemFile);
        }
        //Gắn thêm dấu x xóa từng file
        //các file trước đó đã có trong csdl
        if ($('.ace-file-name').children().hasClass('XoaFileDinhKem')) {
            // Có class "XoaFileDinhKem"
        } else {
            // Không "XoaFileDinhKem"
            $('.ace-file-name').append('<i class=" ace-icon fa fa-times XoaFileDinhKemDT XoaFileDinhKem btn-del-item" onclick="return false"></i>');
            //File thêm mới
            $('.ace-file-name.large').append('<i class=" ace-icon fa fa-times XoaFileDinhKemDT XoaFileDinhKem btn-del-item " onclick="return false"></i>');

        }

        return false;
    });
    var file_input = $('#DinhKem_CauLD_us');
    file_input.ace_file_input('reset_input');
    file_input
        .off('file.error.ace')
        .on('file.error.ace', function (e, info) {
        });

    function RemoveAllFileInputAce() {
        var bang = "CauLaoDong";
        var cot = "CauLaoDongID";

        CanhBaoXoa(() => {
            var result = NTS.getAjax('/DanhMuc/DungChung/XoaDinhKemCungLaoDong', { ID: $('#CauLaoDongID').val(), duongDan: '', bangDk: bang, cotDk: cot, loai: 'all' });
            if (!result.Err) {
                NTS.thanhcong(result.Msg);
                $('#txtDinhKem_VanBan_US').value("");
                ResetDinhKemFile();
                old_ItemFile = "";
                //$('#txtDinhKem_VanBan_US').value($('#txtDinhKem_VanBan_US').value().replaceAll(ListFile[i], '').replaceAll('**', '*'));
            }
            else result.CanhBao ? NTS.canhbao(result.Msg) : NTS.loi(result.Msg);
        });
    }
    var positionRemoveItiem = new Array();
    $(document).on('click', '.XoaFileDinhKem', function () {
        var CungLaoDongID = $('#CauLaoDongID').value();
        var TenFile = $(this).parent().attr('data-title');
        var ListFile = $('#txtDinhKem_VanBan_US').value().split('*');
        //Kiểm tra xem file xóa có phải là file vừa mới upload hay không - nếu là file vừa mới upload thì cho vào list xóa để không upload vào server
        if (!$(this).hasClass('img-db')) {
            var indexRemove = $('.XoaFileDinhKem').index(this);
            positionRemoveItiem.push(indexRemove);
        }
        //
        CanhBaoXoa(() => {
            for (var i = 0; i < ListFile.length; i++) {
                if (ListFile[i].includes(TenFile)) {
                    var bang = "CauLaoDong";
                    var cot = "CauLaoDongID";
                    var result = NTS.getAjax('/DanhMuc/DungChung/XoaDinhKemCungLaoDong', { ID: CungLaoDongID, duongDan: ListFile[i], bangDk: bang, cotDk: cot, loai: '' });

                    if (!result.Err) {
                        NTS.thanhcong(result.Msg);
                        $('#txtDinhKem_VanBan_US').value($('#txtDinhKem_VanBan_US').value().replaceAll(ListFile[i], '').replaceAll('**', '*'))
                    }
                    else {
                        NTS.loi(result.Msg);
                    }
                }
            }
            //$(this).parent().css('display', 'none');
            //if ($('#DinhKem_CauLD_us').parent().find('.ace-file-name').length == 1 && $('#DinhKem_CauLD_us').parent().find('.ace-file-name').css('display') == "none") {
            //    ResetDinhKemFile();
            //}
            $(this).parent().remove();
            if ($('#DinhKem_CauLD_us').parent().find('.ace-file-name').length == 0) {
                ResetDinhKemFile();
            }
        });
        //
        HienThiTatCaToChuc_CLD
    });
    $(document).on('click', '.XemDinhKemHinhAnh_USDangKy', function () {
        var linkImg = $(this).attr("ace-img-url");
        linkImg = linkImg.replace("~", "");
        window.open(linkImg);
        return false;
    });

    function ResetDinhKemFile() {
        $('#DinhKem_CauLD_us').ace_file_input('reset_input');
        $('.ace-file-container').html(`<span class="ace-file-name" data-title="No File ..."><i class=" ace-icon ace-icon fa fa-cloud-upload"></i></span>`);
    }


    //function LoadComBoToChuc(TinhID, HuyenID, XaID, ThonID) {
    //    $('.listOption').html('');
    //    $('#ToChucID_ChuHo').html('');
    //    $('#ListDataToChuc').append(`<li action="false" style="position: sticky;top: 0;background-color: white;">
    //                    <div class="row" style="width: 100%">
    //                    <div class="form-col-12">
    //                        <input type="text" class="form-control" id="ckTimKiemToChuc" onkeypress="FillterToChuc()">
    //                    </div>
    //                    </div>
    //                </li>`);
    //    $('#ListDataToChuc').append(`<li action="chon" class="itemToChuc"><div class="opInfo Chon"><div>-Chọn tổ chức-</div></li>`);
    //    var saveData = new Array();
    //    saveData[0] = TinhID;
    //    saveData[1] = HuyenID;
    //    saveData[2] = XaID;
    //    saveData[3] = ThonID;
    //    const kq = NTS.getAjax('/DanhMuc/DungChung/GetToChuc_Combo', { data: saveData }).Result;
    //    for (var i = 0; i < kq.length; i++) {
    //        $('#ToChucID_ChuHo').append(`<option value="${kq[i].ToChucID}"
    //                        data-name="${kq[i].TenToChuc}"
    //                        data-name-NSD="${TraVeTenVietTat(kq[i].TenNguoiSuDungLD)}"
    //                        data-name-KCN="${kq[i].TenKCN_CLD}"
    //                        data-code="${kq[i].MaToChuc}"
    //                        data-masothue="${kq[i].MaSoThue}"
    //                        data-NoiThuongTru="${kq[i].DiaChiCuThe}"
    //                        data-tinh="${kq[i].Tinh}"
    //                        data-huyen="${kq[i].Huyen}"
    //                        data-xa="${kq[i].Xa}"
    //                        data-thon="${kq[i].Thon}"
    //                        ></option>`);
    //        $('#ToChucID_ChuHo').value(kq[i].ToChucID);
    //        var ToChucID = kq[i].ToChucID;
    //        var name = kq[i].TenToChuc;
    //        var name_NSD = TraVeTenVietTat(kq[i].TenNguoiSuDungLD);
    //        var name_KCN = kq[i].TenKCN_CLD;
    //        var code = kq[i].MaToChuc;
    //        var masothue = kq[i].MaSoThue;
    //        var NoiThuongTru = kq[i].DiaChiCuThe;
    //        var tinh = kq[i].Tinh;
    //        var huyen = kq[i].Huyen;
    //        var xa = kq[i].Xa;
    //        var thon = kq[i].Thon;
    //        const mauNgauNhien = getRandomColors(Color, 1);
    //        var item = "";
    //        item = `<li action="true" class="itemToChuc" data-name="${name}" data-code="${code}"data-NoiThuongTru="${kq[i].DiaChiCuThe}" value="${ToChucID}">
    //                    <div class="opImg" style="background-color:${mauNgauNhien}">${name_NSD}</div>
    //                    <div class="opInfo"><div><b>${name}</b> (${code}), Số ĐKKD/Mã số thuế: <b>${masothue}</b>, Người đại diện: <b>${kq[i].TenNguoiSuDungLD}</b></div>
    //                            <div class="text-diachi" title="${(thon == "" ? "" : thon + ", ")} ${xa}, ${huyen}, ${tinh}">Nơi thường trú: <b>${NoiThuongTru}</b></div></div>
    //                </li>`;
    //        $('#ListDataToChuc').append(item);
    //    }
    //    $('#ListDataToChuc').append(`<li action="false" id="loadMoreToChucDK" onclick="LoadMoreToChuc()" style="justify-content: center;"> Xem thêm &nbsp<i class="fa fa-arrow-down" style="color: #0054a6" aria-hidden="true"></i></li>`);
    //}

    var langArray = [];
    langArray.push(`<li action="false" style="position: sticky;top: 0;background-color: white;">
                        <div class="row" style="width: 100%">
                        <div class="form-col-12">
                            <input type="text" class="form-control" id="ckTimKiemToChuc" >
                        </div>
                        </div>
                    </li>`);
    langArray.push(`<li action="chon"><div class="opInfo Chon"><div style="display: flex;justify-content: space-between;align-items: center;">-Chọn tổ chức- <i class="fa-solid fa-caret-down" style="float: right;"></i></div></li>`);

    const Color = [
        "#0066cc",
        "#cc3300",
        "#993399",
        "#009966",
        "#ff9900",
        "#669900",
        "#cc6600",
        "#663366",
        "#009999",
        "#ff6600",
        "#996633",
        "#336699",
        "#cc6633",
        "#666699",
        "#339966",
        "#ff3366",
        "#663300",
        "#336600",
        "#993300",
        "#003366"
    ];

    $('.vodiapickerDT option').each(function () {

        var name_cv = $(this).attr("data-name-cv");
        var name = $(this).attr("data-name");
        var code = $(this).attr("data-code");
        var genner = $(this).attr("data-genner");
        var cmnd = $(this).attr("data-cmnd");
        var tinh = $(this).attr("data-tinh");
        var huyen = $(this).attr("data-huyen");
        var xa = $(this).attr("data-xa");
        var thon = $(this).attr("data-thon");
        var doiTuongID = $(this).attr("value");
        var NoiThuongTru = $(this).attr("data-NoiThuongTru");
        const mauNgauNhien = getRandomColors(Color, 1);
        var item = "";
        item = `<li class="itemToChuc" action="true" style="display:none" data-name="${name}" data-code="${code}" data-cmnd="${cmnd}" data-NoiThuongTru="${NoiThuongTru}" value="${doiTuongID}"><div class="opImg" style="background-color:${mauNgauNhien}">${name_cv}</div><div class="opInfo"><div><b>${name}</b> (${code}), Giới tính: <b>${genner}</b>, CMND/CCCD: <b>${cmnd}</b></div><div class="text-diachi" title="${(thon == "" ? "" : thon + ", ")} ${xa}, ${huyen}, ${tinh}">Nơi thường trú: <b>${NoiThuongTru}</b></div></div></li>`;

        langArray.push(item);

    });

    //langArray.push(`<li action="false" id="loadMoreToChucDK" onclick="LoadMoreToChuc()" style="justify-content: center;"> Xem thêm &nbsp<i class="fa fa-arrow-down" style="color: #0054a6" aria-hidden="true"></i></li>`);
    $('#ListDataToChuc').html(langArray);

    //Set the button value to the first el of the array
    $('.btn-select').html(langArray[1]);
    $('.btn-select').attr('value', 'en');
    ////change button stuff on click
    //$(document).on('click', '.itemToChuc', function () {
    //    var action = $(this).attr("action");
    //    if (action == "false") {
    //        return;
    //    }
    //    if (action == "chon") {
    //        var item = `<li action="chon"><div class="opInfo Chon"><div style="display: flex;justify-content: space-between;align-items: center;">-Chọn tổ chức- <i class="fa-solid fa-caret-down" style="float: right;"></i></div></li>`;
    //        $('#SelectToChuc_US').value('');
    //        ResetThongTinToChuc();
    //    } else {
    //        var value = $(this).attr('value');
    //        var name = $(this).attr("data-name");
    //        var code = $(this).attr("data-code");
    //        var masothue = $(this).attr("data-masothue");
    //        var NoiThuongTru = $(this).attr("data-NoiThuongTru");
    //        var item = `<li><span><b>${name}</b> <b>(${code})</b> - Nơi thường trú : <b>${NoiThuongTru}</b></span> <i class="fa-solid fa-caret-down" style="float: right;margin-top: 3px;"></i></li>`;

    //        // Load thông tin cá nhân của tổ chức lên modal khi chọn xuống tổ chức
    //        const result = NTS.getAjax('/DanhMuc/ToChuc/LoadDuLieuSua', { id: value });
    //        if (!result.Err && result.Result != null) {
    //            let data = result.Result[0];
    //            $('#ToChucID').value(data.ToChucID);
    //            $('#TenKCN_CLD_CLD').value(data.TenKCN);
    //            $('#MaSoThue_us_CLD').value(data.MaSoThue);
    //            $('#MaToChucUS_CLD').value(data.MaToChuc);
    //            $('#NamTrongKCN_us_CLD').value(data.NamTrongKCN);
    //            $('#TenNguoiSDLD_us_CLD').value(data.TenNguoiSuDungLD);
    //            $('#SoCCCD_us_CLD').value(data.SoCCCD);
    //            $('#LoaiHinhDNID_us_CLD').value(data.LoaiHinhDNID);
    //            $('#TinhTrangHDKTID_us_CLD').value(data.TinhTrangTGHDKTID);
    //            $('#NgayHoatDong_us_CLD').value(data.NgayHoatDong);
    //            $('#NganhNgheChinh_us_CLD').value(JSON.parse(data.NganhKinhTeID));
    //            $('#SoDienThoai_us_CLD').value(data.SoDienThoai);
    //            $('#Email_us_CLD').value(data.Email);
    //            $('#TinhID_us_CLD').value(data.DiaBanHCID_Tinh);
    //            $('#HuyenID_us_CLD').value(data.DiaBanHCID_Huyen);
    //            $('#XaID_us_CLD').value(data.DiaBanHCID_Xa);
    //            $('#ThonID_us_CLD').value(data.DiaBanHCID_Thon);
    //            $('#SoNha_us_CLD').value(data.SoNha);
    //            $('#DiaChi_us_CLD').text(data.DiaChiCuThe);

    //            // lưu giá trị của tổ chức với trang thái ban đầu để so sánh nếu có thay đổi khi tiếp tục thì cảnh bảo
    //            mangGiaTriDau = [];
    //            mangGiaTriDau.push(replaceNullAndEmptyString(data.TenKCN));
    //            mangGiaTriDau.push(replaceNullAndEmptyString(data.MaSoThue));
    //            mangGiaTriDau.push(replaceNullAndEmptyString(data.NamTrongKCN));
    //            mangGiaTriDau.push(replaceNullAndEmptyString(data.TenNguoiSuDungLD));
    //            mangGiaTriDau.push(replaceNullAndEmptyString(data.SoCCCD));
    //            mangGiaTriDau.push(replaceNullAndEmptyString(data.LoaiHinhDNID));
    //            mangGiaTriDau.push(replaceNullAndEmptyString(data.TinhTrangTGHDKTID));
    //            mangGiaTriDau.push(replaceNullAndEmptyString(data.NgayHoatDong));
    //            mangGiaTriDau.push(replaceNullAndEmptyString(JSON.parse(data.NganhKinhTeID)));
    //            mangGiaTriDau.push(replaceNullAndEmptyString(data.SoDienThoai));
    //            mangGiaTriDau.push(replaceNullAndEmptyString(data.Email));
    //            mangGiaTriDau.push(replaceNullAndEmptyString(data.DiaBanHCID_Tinh));
    //            mangGiaTriDau.push(replaceNullAndEmptyString(data.DiaBanHCID_Huyen));
    //            mangGiaTriDau.push(replaceNullAndEmptyString(data.DiaBanHCID_Xa));
    //            mangGiaTriDau.push(replaceNullAndEmptyString(data.DiaBanHCID_Thon));
    //            mangGiaTriDau.push(replaceNullAndEmptyString(data.SoNha));
    //        }
    //        else result.CanhBao ? NTS.canhbao(result.Msg) : NTS.loi(result.Msg);
    //    }

    //    $('.btn-select').html(item);
    //    $('.btn-select').attr('value', value);
    //    $('#ToChucID_ChuHo').value(value);
    //    $(".OptionToChuc").toggle();
    //});

    $(".btn-select").click(function () {
        $(".OptionToChuc").toggle();
    });
    $(document).ready(function () {
        // Bắt sự kiện click trên toàn bộ trang
        $(document).on('click', function (event) {
            // Kiểm tra xem sự kiện click diễn ra bên ngoài thẻ có class A hay không
            if (!$(event.target).closest('.lang-select').length) {

                $(".OptionToChuc").css('display', 'none');
            }
        });
    });
    //check local storage for the lang
    var sessionLang = localStorage.getItem('lang');
    if (sessionLang) {
        //find an item with value of sessionLang
        var langIndex = langArray.indexOf(sessionLang);
        $('.btn-select').html(langArray[langIndex]);
        $('.btn-select').attr('value', sessionLang);
    } else {
        var langIndex = langArray.indexOf('ch');
        $('.btn-select').html(langArray[langIndex]);
        //$('.btn-select').attr('value', 'en');
    }

    function FillterToChuc() {
        var input, filter, ul, li, a, i;
        input = $("#ckTimKiemToChuc");
        filter = input.value().toUpperCase();
        div = $("#ListDataToChuc");
        a = $("#ListDataToChuc li");
        for (i = 0; i < a.length; i++) {
            var txtValue = a[i].textContent || a[i].innerText;
            if (txtValue.toUpperCase().indexOf(filter) > -1) {
                a[i].style.display = "";
            } else {
                if (i != 0) { // khong an thanh tim kiem
                    a[i].style.display = "none";
                }
            }
        }
    }
    function filterFunction() {
        var input, filter, ul, li, a, i;
        input = $("#ckTimKiemToChuc");
        filter = input.value().toUpperCase();
        div = $("#ListDataToChuc");
        a = $("#ListDataToChuc li");
        for (i = 0; i < a.length; i++) {
            var txtValue = a[i].textContent || a[i].innerText;
            if (txtValue.toUpperCase().indexOf(filter) > -1) {
                a[i].style.display = "";
            } else {
                if (i != 0) { // khong an thanh tim kiem
                    a[i].style.display = "none";
                }
            }
        }
    }
    function NumbervisibleLiCountToChuc() {
        var visibleLiCount = $('#ListDataToChuc li').filter(function () {
            return $(this).css('display') === 'flex';
        }).length;
        return visibleLiCount;
    }
    var soLuongHienThi_ToChucDT = 20;
    function LoadMoreToChuc() {
        //so phan tu dang hien thi
        var visibleLiCount = NumbervisibleLiCountToChuc();
        //hien thi them  phan tu nua
        $("#ListDataToChuc li").slice(visibleLiCount - 1, visibleLiCount + soLuongHienThi_ToChucDT - 1).css("display", "flex");
        if (visibleLiCount == $('#ListDataToChuc li').length) {
            $("#ListDataToChuc li").slice(visibleLiCount - 1).css("display", "none");
        }
    }


    function ResetThongTinToChuc() {
        $('#ToChucID').value('');
        $('#TenKCN_CLD_CLD').value('');
        $('#MaSoThue_us_CLD').value('');
        $('#NamTrongKCN_us_CLD').value('');
        $('#TenNguoiSDLD_us_CLD').value('');
        $('#SoCCCD_us_CLD').value('');
        $('#LoaiHinhDNID_us_CLD').value('');
        $('#TinhTrangHDKTID_us_CLD').value('');
        $('#NgayHoatDong_us_CLD').value('');
        $('#NganhNgheChinh_us_CLD').value('');
        $('#SoDienThoai_us_CLD').value('');
        $('#Email_us_CLD').value('');
        $('#TinhID_us_CLD').value('');
        $('#HuyenID_us_CLD').value('');
        $('#XaID_us_CLD').value('');
        $('#ThonID_us_CLD').value('');
        $('#SoNha_us_CLD').value('');
        $('#DiaChi_us_CLD').text('');
        $('#TinhTrangHDKTID_us_CLD option:eq(1)').prop('selected', true);
        $('#TinhTrangHDKTID_us_CLD').trigger('change');
        PhanQuyenComBoDiaBan('TinhID_us_CLD', 'HuyenID_us_CLD', 'XaID_us_CLD', 'ThonID_us_CLD');
        loadMacDinhDiaBanHC_TheoDV();
    }
</script>